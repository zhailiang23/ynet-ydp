# AI 海报生成功能配置指南

## 功能说明

海报生成器使用硅基流动（SiliconFlow）的 FLUX.1-schnell 文生图模型，根据用户输入的标题、副标题和选择的模板，自动生成专业的金融海报。

## 配置步骤

### 1. 获取硅基流动 API 密钥

1. 访问 [硅基流动官网](https://siliconflow.cn/)
2. 注册并登录账号
3. 进入控制台，创建 API 密钥
4. 复制生成的 API 密钥

### 2. 配置环境变量

打开 `frontend-mbda/.env.development` 文件，将您的 API 密钥填入：

```env
VITE_SILICONFLOW_API_KEY=your_actual_api_key_here
```

**重要**: 请将 `your_api_key_here` 替换为您实际的 API 密钥。

### 3. 重启开发服务器

修改环境变量后，需要重启前端开发服务器：

```bash
cd frontend-mbda
pnpm dev
```

## 使用说明

### 1. 访问海报生成器

- 路由: `/tools/poster-generator`
- 或通过工具箱首页 (`/tools`) 点击"海报生成"卡片进入

### 2. 编辑海报内容

1. **选择模板**: 从"热门推荐"、"节日祝福"等分类中选择模板
2. **配图设置**: 可上传自定义图片或从图库选择
3. **编辑内容**:
   - 输入海报标题（支持换行，使用 `\n`）
   - 输入副标题/描述
   - 选择是否显示名片信息

### 3. 生成海报

点击"一键生成并分享"按钮：
- 系统会调用 AI 模型生成海报
- 生成过程中按钮会显示"生成中..."和加载动画
- 生成成功后自动弹出分享对话框

### 4. 分享海报

分享对话框提供以下选项：
- **微信**: 分享到微信好友
- **朋友圈**: 分享到微信朋友圈
- **保存图片**: 下载海报到本地
- **复制链接**: 复制海报链接

## API 技术细节

### 使用的模型

- **模型**: black-forest-labs/FLUX.1-schnell
- **图片尺寸**: 576x1024 (接近 9:14 比例)
- **推理步数**: 20
- **引导系数**: 7.5

### 提示词构建

系统会根据用户输入自动构建英文提示词，包含：
- 海报主标题和副标题
- 设计风格（现代、专业、金融风格）
- 主题色（#137fec 蓝色）
- 布局要求
- 名片信息（如果启用）

### API 调用流程

1. 前端收集用户输入
2. 构建提示词
3. 调用硅基流动 API 生成图片
4. 返回图片 URL
5. 显示分享对话框

## 注意事项

1. **API 密钥安全**:
   - 不要将 API 密钥提交到代码仓库
   - `.env.development` 已添加到 `.gitignore`

2. **生成时间**:
   - 通常需要 5-15 秒
   - 请耐心等待，不要重复点击

3. **费用**:
   - 硅基流动采用按次计费
   - 建议查看官网定价说明

4. **错误处理**:
   - 如果生成失败，会显示错误提示
   - 常见原因：API 密钥无效、配额不足、网络问题

## 开发调试

### 查看 API 请求

打开浏览器开发者工具的 Network 面板，筛选 `siliconflow` 可以看到 API 请求详情。

### 测试提示词

可以在 `src/api/ai-poster.ts` 的 `buildPrompt` 函数中修改提示词模板。

### 模拟 API 响应

在开发阶段，可以暂时注释掉真实 API 调用，返回模拟数据：

```typescript
// 模拟响应（用于测试）
return {
  imageUrl: 'https://example.com/test-poster.png',
  taskId: 'test-' + Date.now(),
}
```

## 相关文件

- `src/views/tools/poster-generator.vue` - 海报生成器页面组件
- `src/api/ai-poster.ts` - AI 海报生成 API
- `.env.development` - 环境变量配置

## 常见问题

### Q: 为什么点击生成没有反应？

A: 检查以下几点：
1. 是否正确配置了 API 密钥
2. 浏览器控制台是否有错误信息
3. 网络是否正常

### Q: 如何更换其他模型？

A: 在 `src/api/ai-poster.ts` 中修改 `model` 参数，可选模型参考硅基流动文档。

### Q: 能否自定义图片尺寸？

A: 可以修改 `image_size` 参数，但需要符合模型支持的尺寸。

---

**技术支持**: 如有问题，请查看硅基流动官方文档或联系技术团队。
