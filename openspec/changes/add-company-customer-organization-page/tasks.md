# Tasks: 实现对公客户组织架构信息页面

## 任务概述

实现对公客户360视图的组织架构信息页面，展示客户的组织架构树形结构。

## 任务列表

### 1. 前期准备 ⏱️ 0.5h

- [ ] **T1.1** 检查前端 API 客户端是否存在
  - 检查文件：`frontend/apps/web-antd/src/api/aicrm/company-organization.ts`
  - 如不存在，创建 API 客户端文件
  - 实现 `getCompanyOrganizationPage` 方法

- [ ] **T1.2** 检查字典数据是否已配置
  - 检查字典类型：`aicrm_org_type`（组织类型）
  - 检查字典类型：`aicrm_org_status`（组织状态）
  - 如不存在，创建 SQL 脚本插入字典数据

### 2. 组织架构信息页面开发 ⏱️ 2h

- [ ] **T2.1** 创建组织架构信息页面基础结构
  - 创建文件：`frontend/apps/web-antd/src/views/aicrm/company-customer/pages/organization-info.vue`
  - 定义组件基础结构（模板、脚本、样式）
  - 定义 Props 接收 customer 对象

- [ ] **T2.2** 实现数据加载逻辑
  - 定义组织架构数据类型
  - 实现 `loadOrganizations` 方法调用后端 API
  - 处理加载状态和错误处理
  - 实现数据刷新功能

- [ ] **T2.3** 实现树形表格展示
  - 配置 VxeTable 树形表格
  - 配置 `tree-config` 属性（`parent: 'parentId', children: 'children'`）
  - 定义表格列：
    - 组织名称（树形列，`tree-node: true`）
    - 组织编码
    - 组织类型（字典映射）
    - 组织层级
    - 负责人姓名
    - 负责人职位
    - 员工人数
    - 组织状态（字典映射）
  - 配置展开/收起功能

- [ ] **T2.4** 实现数据格式化和字典映射
  - 实现组织类型字典映射
  - 实现组织状态字典映射
  - 格式化成立日期字段
  - 处理空值显示为 "-"

- [ ] **T2.5** 实现页面样式和布局
  - 使用 Card 组件包裹表格
  - 添加页面标题和刷新按钮
  - 调整表格样式（高度、边框等）
  - 响应式布局调整

### 3. 导航菜单集成 ⏱️ 0.5h

- [ ] **T3.1** 修改对公客户详情页导航配置
  - 修改文件：`frontend/apps/web-antd/src/views/aicrm/company-customer/detail.vue`
  - 导入 `OrganizationInfo` 组件
  - 将菜单项 `organization` 的 `component` 从 `Placeholder` 改为 `OrganizationInfo`

- [ ] **T3.2** 测试导航切换
  - 测试点击"组织架构信息"菜单项
  - 验证页面正确加载
  - 验证左侧菜单高亮状态

### 4. 测试验证 ⏱️ 0.5h

- [ ] **T4.1** 功能测试
  - 验证页面能正确加载组织架构数据
  - 验证树形结构展开/收起功能
  - 验证字典值映射正确（组织类型、组织状态）
  - 验证数据格式化正确（日期、空值等）
  - 验证刷新按钮功能

- [ ] **T4.2** 界面测试
  - 验证页面布局和样式
  - 验证表格列宽和对齐
  - 验证响应式布局
  - 验证 Dark Mode 样式

- [ ] **T4.3** 兼容性测试
  - 测试不同层级的组织架构（1-3 层）
  - 测试不同客户的组织架构数据
  - 测试空数据情况

### 5. 文档更新（可选）

- [ ] **T5.1** 更新开发文档
  - 记录组件实现方式
  - 记录关键配置和注意事项

## 依赖关系

```
T1.1, T1.2 (并行)
  ↓
T2.1
  ↓
T2.2
  ↓
T2.3
  ↓
T2.4
  ↓
T2.5
  ↓
T3.1
  ↓
T3.2, T4.1, T4.2, T4.3 (并行)
  ↓
T5.1 (可选)
```

## 总时间估算

- 前期准备：0.5 小时
- 页面开发：2 小时
- 导航集成：0.5 小时
- 测试验证：0.5 小时
- **总计：约 3.5 小时**

## 完成标准

- ✅ 组织架构信息页面成功展示
- ✅ 树形结构正确展示父子关系
- ✅ 字典值映射正确
- ✅ 数据格式化正确
- ✅ 刷新功能正常工作
- ✅ 左侧导航集成成功
- ✅ 页面样式符合设计规范
- ✅ 通过所有测试用例
